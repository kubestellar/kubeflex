name: E2E (Released Kubeflex)

on:
  workflow_dispatch:
    inputs:
      release:
        description: "Kubeflex release to test (e.g. latest or v0.5.1)"
        required: true
        default: "latest"

jobs:
  e2e-release:
    runs-on: ubuntu-latest

    steps: 
      - uses: actions/checkout@v4

      - name: Set up Go
        uses: actions/setup-go@v5
        with:
          go-version: "1.22"

      - name: Install kind
        uses: helm/kind-action@v1

      - name: Run E2E against released kubeflex
        env:
          KUBEFLEX_RELEASE: ${{ inputs.release }}
        run: |
          test/e2e/run.sh
